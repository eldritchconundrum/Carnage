<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="fr" ng-app="carnage">
  <title>Carnage</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf8">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.2/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.2/angular-animate.js"></script>
    <script src="https://cdn.firebase.com/js/client/2.0.5/firebase.js"></script>

    <script src="https://cdn.firebase.com/libs/angularfire/0.9.0/angularfire.min.js"></script>
    <script src="controllers.js"></script>

    <link rel="stylesheet" href="style.css" />
  </head>

<body ng-app="ngAnimate" ng-controller="CarnageCtrl">

  <div class="header">
    <h1>Carnage</h1>
  </div>

<div class="page">

  <div class="chat" ng-controller="PublicChatCtrl">

    <h2>Discussions publiques</h2>

    <ul>
      <li ng-repeat="msg in messages | limitTo:-20"><span>
        <strong class="chat-username">{{msg.from}}: </strong>
        {{msg.body}}
      </span></li>
    </ul>

    <input ng-show="name" ng-model="msg" ng-keydown="addMessage($event)"
             type="text" id="messageInput" placeholder="Votre message..."
             style="width:99%">

  </div>

  <div ng_show="page == 'menu'" class="main">

    <div class="online">
      <h2>Joueurs en ligne</h2>
      <ul>
        <li ng-repeat="player in connected">
          {{player.$id}}
        </li>
      </ul>
    </div>

    <div ng-show="menuPage == 'name'">
      <h2>Bienvenue</h2>

      <button ng-click="page='game'">pouet</button>

      <input ng-model="tmp_name" ng-keydown="setName($event)" type="text"
             id="nameInput" placeholder="Entrez votre nom">
      <p class="stderr" ng-show="showStderr">{{stderr}}</p>
    </div>

    <div ng-show="menuPage == 'list'">

      <h2>Liste des parties</h2>
      <ul>
        <li ng-repeat="room in rooms">
          Partie créée par {{room.owner}}.
          <button ng-click="joinGame(room.$id)">Rejoindre</button>
        </li>
      </ul>

      <button ng-click="createGame()">Nouvelle partie</button>
    </div>

    <div ng-show="menuPage == 'room'">
      <h2>Joueurs dans la partie</h2>
      <p ng-show="roomPlayers.length == 0">
        La partie a été annulée.
      </p>
      <ul ng-show="roomPlayers.length > 0">
        <li ng-repeat="player in roomPlayers">
          {{player.name}}
          <span ng-show="player.name == room.owner">(créateur)</span>
        </li>
      </ul>
      <button ng-click="cancelGame()">Quitter</button>
      <button ng-click="startGame()" ng-show="room.owner == name">Commencer</button>
      <p class="stderr" ng-show="showStderr">{{stderr}}</p>
    </div>
  </div>

  <div ng-show="page == 'game'" style="width: 100%" class="main">

    <div style="position: relative; width: 500px; height: 500px">

      <div ng-repeat="c in map"
           class="{{c.st}}"
           style="{{pos(c.x, c.y)}} background-color:{{c.sel ? '#999' : '#ccc'}}"
           ng-click="select(c)">

      </div>

    </div>

    <!-- <div class="player"> -->
    <!--   <h3>Ta main</h3> -->
    <!--   <div class="card"><span>12</span></div> -->
    <!--   <div class="card"><span>8</span></div> -->
    <!--   <div class="card"><span>X</span></div> -->
    <!--   <div class="card"><span>12</span></div> -->
    <!--   <div class="card"><span>8</span></div> -->
    <!--   <div class="card"><span>X</span></div> -->
    <!-- </div> -->

  </div>
</div>

</body>
</html>
